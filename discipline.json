{
  "address": "8d8w7DMGf8G41nmg2qnDGDqL6d4hGABNPHLpTnTUfoqn",
  "metadata": {
    "name": "discipline",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Created with Anchor"
  },
  "instructions": [
    {
      "name": "create_task",
      "docs": ["Create a new task by staking SOL into the per-task Vault PDA."],
      "discriminator": [194, 80, 6, 180, 232, 127, 48, 171],
      "accounts": [
        {
          "name": "owner",
          "writable": true,
          "signer": true
        },
        {
          "name": "task",
          "docs": ["Task PDA derived using (b\"task\", owner, task_id)"],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [116, 97, 115, 107]
              },
              {
                "kind": "account",
                "path": "owner"
              },
              {
                "kind": "arg",
                "path": "task_id"
              }
            ]
          }
        },
        {
          "name": "vault",
          "docs": ["Vault PDA holds the staked lamports. Derived from task."],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [118, 97, 117, 108, 116]
              },
              {
                "kind": "account",
                "path": "task"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        },
        {
          "name": "clock",
          "address": "SysvarC1ock11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "task_id",
          "type": "u64"
        },
        {
          "name": "description",
          "type": "string"
        },
        {
          "name": "duration",
          "type": "i64"
        },
        {
          "name": "stake_amount",
          "type": "u64"
        }
      ]
    },
    {
      "name": "resolve_task",
      "docs": [
        "Resolve a task after expiry: return SOL to owner if completed, else donate to charity."
      ],
      "discriminator": [116, 245, 180, 251, 30, 233, 101, 33],
      "accounts": [
        {
          "name": "owner",
          "writable": true,
          "signer": true,
          "relations": ["task"]
        },
        {
          "name": "task",
          "docs": ["Task (must be owned by signer)"],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [116, 97, 115, 107]
              },
              {
                "kind": "account",
                "path": "task.owner",
                "account": "Task"
              },
              {
                "kind": "account",
                "path": "task.task_id",
                "account": "Task"
              }
            ]
          }
        },
        {
          "name": "vault",
          "docs": ["Task vault holding escrowed SOL."],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [118, 97, 117, 108, 116]
              },
              {
                "kind": "account",
                "path": "task"
              }
            ]
          }
        },
        {
          "name": "charity",
          "docs": [
            "Charity receiving account (must match hardcoded pubkey)",
            "Keep writable as it will receive lamports when donating.",
            "We validate its key equals the constant."
          ],
          "writable": true
        },
        {
          "name": "global_state",
          "docs": ["Global state for donation tally. Auto-init on demand."],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [115, 116, 97, 116, 101]
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        },
        {
          "name": "clock",
          "address": "SysvarC1ock11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "task_id",
          "type": "u64"
        },
        {
          "name": "completed",
          "type": "bool"
        }
      ]
    }
  ],
  "accounts": [
    {
      "name": "GlobalState",
      "discriminator": [163, 46, 74, 168, 216, 123, 133, 98]
    },
    {
      "name": "Task",
      "discriminator": [79, 34, 229, 55, 88, 90, 55, 84]
    },
    {
      "name": "Vault",
      "discriminator": [211, 8, 232, 43, 2, 152, 117, 119]
    }
  ],
  "events": [
    {
      "name": "CharityTotal",
      "discriminator": [236, 248, 67, 136, 201, 192, 149, 213]
    },
    {
      "name": "TaskCreated",
      "discriminator": [49, 174, 6, 7, 71, 159, 69, 175]
    },
    {
      "name": "TaskResolved",
      "discriminator": [124, 29, 208, 226, 46, 166, 188, 14]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "Unauthorized",
      "msg": "Only the task owner can perform this action."
    },
    {
      "code": 6001,
      "name": "NotExpired",
      "msg": "Task has not expired yet."
    },
    {
      "code": 6002,
      "name": "AlreadyResolved",
      "msg": "Task already resolved."
    },
    {
      "code": 6003,
      "name": "InvalidCharityWallet",
      "msg": "Invalid charity wallet provided."
    },
    {
      "code": 6004,
      "name": "DescriptionTooLong",
      "msg": "Description too long."
    },
    {
      "code": 6005,
      "name": "InvalidStakeAmount",
      "msg": "Stake amount must be greater than zero."
    },
    {
      "code": 6006,
      "name": "DonationOverflow",
      "msg": "Donation overflow occurred."
    }
  ],
  "types": [
    {
      "name": "CharityTotal",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "total_donated",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "GlobalState",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "total_donated",
            "type": "u64"
          },
          {
            "name": "state_bump",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "Task",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "task_id",
            "type": "u64"
          },
          {
            "name": "owner",
            "type": "pubkey"
          },
          {
            "name": "description",
            "type": "string"
          },
          {
            "name": "stake_amount",
            "type": "u64"
          },
          {
            "name": "expires_at",
            "type": "i64"
          },
          {
            "name": "status",
            "type": {
              "defined": {
                "name": "TaskStatus"
              }
            }
          },
          {
            "name": "task_bump",
            "type": "u8"
          },
          {
            "name": "vault_bump",
            "type": "u8"
          }
        ]
      }
    },
    {
      "name": "TaskCreated",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "task",
            "type": "pubkey"
          },
          {
            "name": "owner",
            "type": "pubkey"
          },
          {
            "name": "task_id",
            "type": "u64"
          },
          {
            "name": "stake_amount",
            "type": "u64"
          },
          {
            "name": "expires_at",
            "type": "i64"
          }
        ]
      }
    },
    {
      "name": "TaskResolved",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "task",
            "type": "pubkey"
          },
          {
            "name": "owner",
            "type": "pubkey"
          },
          {
            "name": "task_id",
            "type": "u64"
          },
          {
            "name": "completed",
            "type": "bool"
          },
          {
            "name": "amount_transferred",
            "type": "u64"
          }
        ]
      }
    },
    {
      "name": "TaskStatus",
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Pending"
          },
          {
            "name": "Completed"
          },
          {
            "name": "Failed"
          }
        ]
      }
    },
    {
      "name": "Vault",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "task",
            "type": "pubkey"
          },
          {
            "name": "vault_bump",
            "type": "u8"
          }
        ]
      }
    }
  ]
}
